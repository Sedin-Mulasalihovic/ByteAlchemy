<!DOCTYPE html>
<html lang="de">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1"
    />
    <title>ByteAlchemy</title>
    <style>
      :root {
        --bg: #050912;
        --card: rgba(255, 255, 255, 0.04);
        --glass: rgba(255, 255, 255, 0.06);
        --accent: #22d3ee;
        --accent-alt: #8b5cf6;
        --text: #e6eef6;
        --muted: #9aa4b2;
        --navbar-height: 72px;
      }
      html,
      body {
        height: 100%;
        margin: 0;
        padding: 0;
        overflow-x: hidden;
        font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto,
          "Helvetica Neue", Arial;
        background: radial-gradient(
          circle at 10% 10%,
          #071025 0%,
          #050912 50%,
          #030612 100%
        );
        color: var(--text);
        scroll-behavior: smooth;
      }

      /* NAV / LAYOUT (unver√§ndert gr√∂√ütenteils) */
      nav.navbar {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        height: var(--navbar-height);
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0 28px;
        background: linear-gradient(
          180deg,
          rgba(6, 10, 18, 0.6),
          rgba(6, 10, 18, 0.45)
        );
        backdrop-filter: blur(8px) saturate(1.1);
        border-bottom: 1px solid rgba(255, 255, 255, 0.04);
        z-index: 1000;
      }
      .logout-btn {
        background: linear-gradient(90deg, var(--accent), var(--accent-alt));
        color: white;
        cursor: pointer;
        width: 100%;
        padding: 10px 14px;
        border-radius: 10px;
        border: none;
        font-weight: 700;
      }
      .nav-logo {
        color: var(--accent);
        font-weight: 800;
        letter-spacing: 1px;
        font-size: 1.4rem;
      }
      .nav-links {
        list-style: none;
        margin: 0;
        padding: 0;
        display: flex;
        gap: 20px;
        align-items: center;
      }
      .nav-links a {
        color: var(--text);
        text-decoration: none;
        font-weight: 600;
        display: inline-flex;
        gap: 8px;
        align-items: center;
      }
      .nav-links a:hover {
        color: var(--accent);
      }
      .nav-toggle {
        display: none;
        flex-direction: column;
        cursor: pointer;
        gap: 4px;
      }
      .nav-toggle span {
        display: block;
        width: 24px;
        height: 3px;
        background: var(--accent);
        border-radius: 2px;
        transition: all 0.3s ease;
      }
      .mobile-menu {
        display: flex;
        flex-direction: column;
        overflow: hidden;
        max-height: 0;
        opacity: 0;
        transition: max-height 0.35s ease, opacity 0.35s ease;
        position: absolute;
        top: var(--navbar-height);
        right: 0;
        background: rgba(6, 10, 18, 0.95);
        backdrop-filter: blur(8px) saturate(1.1);
        width: 200px;
        border-radius: 0 0 10px 10px;
        padding: 12px 0;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.5);
        z-index: 999;
      }
      .mobile-menu.show {
        max-height: 500px;
        opacity: 1;
      }
      .mobile-menu a {
        padding: 10px 20px;
        display: block;
        color: var(--text);
        text-decoration: none;
        font-weight: 600;
      }
      .mobile-menu a:hover {
        background: rgba(34, 211, 238, 0.1);
        color: var(--accent);
      }

      /* Logo + hero */
      .logo {
        width: 110px;
        height: 110px;
        border-radius: 20px;
        background: linear-gradient(135deg, var(--accent), var(--accent-alt));
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 800;
        color: #041015;
        font-size: 34px;
        margin-bottom: 18px;
        box-shadow: 0 6px 30px rgba(139, 92, 246, 0.35);
        animation: logoGlow 3s ease-in-out infinite alternate;
      }
      @keyframes logoGlow {
        from {
          box-shadow: 0 6px 18px rgba(139, 92, 246, 0.25);
        }
        to {
          box-shadow: 0 10px 40px rgba(139, 92, 246, 0.9);
        }
      }

      h1 {
        font-size: 2.2rem;
        margin: 8px 0 6px 0;
        color: var(--accent);
      }
      #usernameDisplay {
        font-size: 1.2rem;
        color: var(--accent-alt);
        margin-bottom: 18px;
        text-shadow: 0 0 10px rgba(139, 92, 246, 0.35);
      }

      section {
        padding-top: calc(var(--navbar-height) + 36px);
        padding-bottom: 60px;
        min-height: calc(100vh - var(--navbar-height));
        box-sizing: border-box;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        text-align: center;
      }

      .card {
        width: 100%;
        max-width: 760px;
        background: var(--glass);
        border-radius: 16px;
        padding: 22px;
        margin: 18px;
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.5);
        border: 1px solid rgba(255, 255, 255, 0.04);
        backdrop-filter: blur(6px) saturate(1.05);
        text-align: left;
      }

      h2 {
        color: var(--accent);
        margin: 0 0 12px 0;
      }

      .chat-box {
        background: rgba(255, 255, 255, 0.03);
        border-radius: 10px;
        padding: 12px;
        max-height: 38vh;
        min-height: 180px;
        overflow: auto;
        border: 1px solid rgba(255, 255, 255, 0.04);
        margin-bottom: 12px;
      }

      .message {
        margin-bottom: 8px;
        font-size: 15px;
      }

      .message .user {
        color: var(--accent);
        font-weight: 700;
        margin-right: 6px;
      }

      input[type="text"],
      textarea {
        width: 100%;
        max-width: 100%;
        padding: 12px;
        border-radius: 10px;
        border: 1px solid rgba(255, 255, 255, 0.08);
        background: rgba(0, 0, 0, 0.25);
        color: var(--text);
        font-size: 16px;
        outline: none;
        box-sizing: border-box;
      }

      input[type="text"]:focus,
      textarea:focus {
        box-shadow: 0 0 0 3px rgba(34, 211, 238, 0.08);
        border-color: var(--accent);
      }

      .controls {
        display: flex;
        gap: 12px;
        align-items: center;
        margin-top: 8px;
      }

      /* ---- GLOBAL BUTTON STYLE (WICHTIG) ----
         Buttons f√ºr Antworten nutzen jetzt diese Klasse:
         .btn
         Vorher war nur .controls .btn definiert -> auf Handys au√üerhalb .controls kein Style */
      .btn {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        padding: 10px 14px;
        border-radius: 10px;
        border: none;
        cursor: pointer;
        font-weight: 700;
        background: linear-gradient(90deg, var(--accent), var(--accent-alt));
        color: #041015;
        transition: transform 0.12s ease, opacity 0.12s ease;
        -webkit-appearance: none;
        box-shadow: 0 4px 18px rgba(139, 92, 246, 0.08);
      }
      .btn:active {
        transform: translateY(1px);
      }
      .btn:disabled {
        opacity: 0.5;
        cursor: default;
      }

      /* Quest done label (gut sichtbar) */
      .quest-done-label {
        margin-top: 10px;
        padding: 8px;
        background: rgba(0, 255, 0, 0.08);
        border: 1px solid rgba(0, 255, 0, 0.3);
        border-radius: 8px;
        color: limegreen;
        font-weight: 700;
        text-align: center;
        animation: fadeIn 0.45s ease forwards;
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: scale(0.98);
        }
        to {
          opacity: 1;
          transform: scale(1);
        }
      }

      #leaderboardList div {
        background: rgba(255, 255, 255, 0.035);
        padding: 10px 12px;
        border-radius: 10px;
        margin-bottom: 10px;
        display: flex;
        flex-direction: column;
        gap: 8px;
      }
      .bar-container {
        width: 100%;
        height: 12px;
        background: rgba(255, 255, 255, 0.06);
        border-radius: 8px;
        overflow: hidden;
      }
      .bar {
        height: 100%;
        width: 0%;
        border-radius: 8px;
        background: linear-gradient(90deg, var(--accent), var(--accent-alt));
        transition: width 1s cubic-bezier(0.2, 0.9, 0.3, 1);
      }

      .fade-in {
        opacity: 0;
        transform: translateY(14px);
        transition: opacity 0.6s ease, transform 0.6s ease;
      }
      .fade-in.visible {
        opacity: 1;
        transform: none;
      }
      .quest-complete {
        animation: questCompletePop 0.6s ease forwards;
      }
      @keyframes questCompletePop {
        0% {
          transform: scale(1);
          box-shadow: 0 0 0 rgba(0, 255, 0, 0);
        }
        50% {
          transform: scale(1.05);
          box-shadow: 0 0 20px rgba(0, 255, 0, 0.6);
        }
        100% {
          transform: scale(1);
          box-shadow: 0 0 0 rgba(0, 255, 0, 0);
        }
      }

      /* Mobile tweaks */
      @media (max-width: 600px) {
        :root {
          --navbar-height: 64px;
        }
        .btn {
          width: 100%;
          padding: 14px 16px;
          font-size: 16px;
        }
        .controls {
          flex-direction: column;
        }
        .logo {
          width: 88px;
          height: 88px;
        }
        .card {
          padding: 16px;
        }
      }
    </style>
  </head>
  <body>
    <!-- NAVBAR -->
    <nav class="navbar">
      <div class="nav-logo">BA</div>
      <div class="nav-toggle" id="navToggle">
        <span></span><span></span><span></span>
      </div>
      <ul class="nav-links">
        <li><a href="#chat">üí¨ Chat</a></li>
        <li><a href="#quests">üß© Quests</a></li>
        <li><a href="#leaderboard">üèÜ Leaderboard</a></li>
        <li>
          <button class="logout-btn" onclick="logout()">üö™ Logout</button>
        </li>
      </ul>
      <div class="mobile-menu" id="mobileMenu">
        <a href="#chat">üí¨ Chat</a>
        <a href="#quests">üß© Quests</a>
        <a href="#leaderboard">üèÜ Leaderboard</a>
        <button onclick="logout()">üö™ Logout</button>
      </div>
    </nav>

    <!-- HERO -->
    <section id="hero" class="fade-in">
      <div class="logo">BA</div>
      <h1>Willkommen bei ByteAlchemy</h1>
      <p id="usernameDisplay">Lade Benutzerinformationen...</p>
    </section>

    <!-- CHAT -->
    <section id="chat" class="fade-in">
      <div class="card">
        <h2>üí¨ Globaler Chat</h2>
        <div id="chatBox" class="chat-box"></div>
        <div style="display: flex; flex-direction: column; gap: 8px">
          <input
            id="chatInput"
            type="text"
            placeholder="Nachricht eingeben..."
            autocomplete="off"
          />
          <div class="controls">
            <button id="sendBtn" class="btn">Senden</button>
            <div style="flex: 1"></div>
            <div
              id="chatResetInfo"
              style="font-size: 13px; color: var(--muted)"
            >
              Letzter Reset: wird geladen...
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- QUESTS -->
    <section id="quests" class="fade-in">
      <div class="card">
        <h2>üß© Quests</h2>
        <div id="questsList">Lade Quests...</div>
      </div>
    </section>

    <!-- LEADERBOARD -->
    <section id="leaderboard" class="fade-in">
      <div class="card">
        <h2>üèÜ Leaderboard</h2>
        <div id="leaderboardList">Lade Leaderboard...</div>
      </div>
    </section>

    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

    <script>
      const firebaseConfig = {
        apiKey: "AIzaSyCUUJ-Cjx2fS3d4z4BGy_wYMvg91HSUd08",
        authDomain: "bytealchemy-2ba0b.firebaseapp.com",
        projectId: "bytealchemy-2ba0b",
      };
      firebase.initializeApp(firebaseConfig);
      const auth = firebase.auth();
      const db = firebase.firestore();

      const usernameDisplay = document.getElementById("usernameDisplay");
      const chatBox = document.getElementById("chatBox");
      const chatInput = document.getElementById("chatInput");
      const sendBtn = document.getElementById("sendBtn");
      const chatResetInfo = document.getElementById("chatResetInfo");
      const leaderboardList = document.getElementById("leaderboardList");
      const questsList = document.getElementById("questsList");
      const navToggle = document.getElementById("navToggle");
      const mobileMenu = document.getElementById("mobileMenu");

      navToggle.addEventListener("click", () => {
        mobileMenu.classList.toggle("show");
      });

      chatInput.addEventListener("keydown", (e) => {
        if (e.key === "Enter") {
          e.preventDefault();
          sendMessage();
        }
      });
      sendBtn.addEventListener("click", sendMessage);

      // Auth listener
      auth.onAuthStateChanged(async (user) => {
        if (!user) {
          window.location.href = "index.html";
          return;
        }
        await user.reload();
        if (!user.emailVerified) {
          await auth.signOut();
          window.location.href = "index.html";
          return;
        }

        const userRef = db.collection("users").doc(user.uid);
        const doc = await userRef.get();
        if (!doc.exists) {
          await userRef.set({
            username: user.displayName || user.email.split("@")[0],
            email: user.email,
            totalXP: 0,
            level: 0,
          });
        }
        usernameDisplay.textContent = `üëã Willkommen, ${
          (await userRef.get()).data().username
        }!`;

        // Wenn du Chat willst, entferne das display:none weiter oben
        loadChat();
        addSampleQuests();
        loadQuests();
        loadLeaderboard();
        cleanupOldMessages();
        setInterval(cleanupOldMessages, 3600000);
      });

      async function logout() {
        await auth.signOut();
        window.location.href = "index.html";
      }

      async function addXP(userId, xpToAdd) {
        const userRef = db.collection("users").doc(userId);
        await db.runTransaction(async (tx) => {
          const d = await tx.get(userRef);
          if (!d.exists) return;
          let totalXP = (d.data().totalXP || 0) + xpToAdd;
          let level = Math.floor(totalXP / 100);
          tx.update(userRef, { totalXP, level });
        });
        loadLeaderboard();
      }

      async function sendMessage() {
        const text = chatInput.value.trim();
        if (!text) return;
        const user = auth.currentUser;
        if (!user) return;
        const udoc = await db.collection("users").doc(user.uid).get();
        const uname = udoc.exists ? udoc.data().username : user.email;
        try {
          await db.collection("messages").add({
            user: uname,
            text,
            createdAt: firebase.firestore.FieldValue.serverTimestamp(),
          });
          chatInput.value = "";
          addXP(user.uid, 5);
        } catch (e) {
          console.error("chat send error", e);
        }
      }

      function escapeHtml(str) {
        if (!str) return "";
        return String(str)
          .replace(/&/g, "&amp;")
          .replace(/</g, "&lt;")
          .replace(/>/g, "&gt;")
          .replace(/"/g, "&quot;")
          .replace(/'/g, "&#039;");
      }

      async function cleanupOldMessages() {
        try {
          const oneHourAgo = new Date(Date.now() - 3600000);
          const old = await db
            .collection("messages")
            .where("createdAt", "<", oneHourAgo)
            .get();
          old.forEach(async (d) => {
            await db.collection("messages").doc(d.id).delete();
          });
        } catch (e) {
          console.warn("cleanup error", e);
        }
        chatResetInfo.textContent = `Letzter Reset: ${new Date().toLocaleTimeString(
          "de-DE",
          { hour: "2-digit", minute: "2-digit" }
        )}`;
      }

      async function loadChat() {
        // falls Chat gebraucht: live updates
        try {
          const messagesRef = db
            .collection("messages")
            .orderBy("createdAt", "desc")
            .limit(50);
          messagesRef.onSnapshot((snapshot) => {
            chatBox.innerHTML = "";
            const messages = snapshot.docs.reverse();
            messages.forEach((doc) => {
              const msg = doc.data();
              const div = document.createElement("div");
              const time = msg.createdAt
                ? msg.createdAt.toDate().toLocaleTimeString("de-DE", {
                    hour: "2-digit",
                    minute: "2-digit",
                  })
                : "";
              div.className = "message";
              div.innerHTML = `<span class="user">${escapeHtml(
                msg.user
              )}:</span> ${escapeHtml(
                msg.text
              )} <span style="color:var(--muted);font-size:12px;">${time}</span>`;
              chatBox.appendChild(div);
            });
            chatBox.scrollTop = chatBox.scrollHeight;
          });
        } catch (e) {
          console.warn("chat load error", e);
        }
      }

      async function loadQuests() {
        const user = auth.currentUser;
        if (!user) return;

        // Lade Fortschritt des Nutzers
        let completedQuests = new Set();
        try {
          const userProgressRef = db
            .collection("users")
            .doc(user.uid)
            .collection("progress");
          const progressSnap = await userProgressRef.get();
          progressSnap.forEach((doc) => {
            if (doc.data().done) completedQuests.add(doc.id);
          });
        } catch (e) {
          console.error("progress load error", e);
        }

        // Lade Quests
        try {
          const snap = await db.collection("quests").get();
          questsList.innerHTML = "";
          if (snap.empty) {
            questsList.textContent =
              "Noch keine Quests vorhanden ‚Äì f√ºge welche in Firestore hinzu!";
            return;
          }

          snap.forEach((d) => {
            const q = d.data();
            const wrapper = document.createElement("div");
            wrapper.dataset.questId = d.id;
            wrapper.className = "quest-wrapper";
            wrapper.style.marginBottom = "12px";
            wrapper.style.padding = "10px";
            wrapper.style.borderRadius = "10px";
            wrapper.style.transition = "background 0.5s, box-shadow 0.5s";

            const title = document.createElement("strong");
            title.textContent = q.title || "Quest";
            wrapper.appendChild(title);
            wrapper.insertAdjacentHTML(
              "beforeend",
              ` (${escapeHtml(
                q.category || ""
              )})<br><p style="margin:6px 0">${escapeHtml(
                q.question || ""
              )}</p>`
            );

            const answersDiv = document.createElement("div");
            answersDiv.style.display = "flex";
            answersDiv.style.flexWrap = "wrap";
            answersDiv.style.gap = "8px";

            // Wenn Quest abgeschlossen, sofort als "erledigt" markieren
            if (completedQuests.has(d.id)) {
              showQuestCompleted(wrapper);
            } else {
              (q.answers || []).forEach((a, i) => {
                const btn = document.createElement("button");
                btn.className = "btn";
                btn.style.padding = "8px 10px";
                btn.style.fontWeight = "600";
                btn.style.borderRadius = "8px";
                btn.textContent = a;
                btn.onclick = () =>
                  checkAnswer(d.id, i, q.correctIndex, q.xp || 10, wrapper);
                answersDiv.appendChild(btn);
              });
            }

            wrapper.appendChild(answersDiv);
            questsList.appendChild(wrapper);
          });
        } catch (e) {
          console.error("quest load error", e);
          questsList.textContent = "Fehler beim Laden der Quests.";
        }
      }

      function showQuestCompleted(wrapper) {
        wrapper.style.background = "rgba(0,128,0,0.15)";
        wrapper.style.boxShadow = "0 0 10px rgba(0,255,0,0.4)";
        wrapper.style.transform = "scale(1.01)";
        wrapper.classList.add("quest-complete");
        // Entferne Buttons (falls noch da) und setze Label
        wrapper.querySelectorAll("button").forEach((b) => b.remove());
        let doneLabel = document.createElement("div");
        doneLabel.className = "quest-done-label";
        doneLabel.innerHTML =
          "‚úÖ <strong>Quest abgeschlossen!</strong><br><small style='color:var(--muted)'>Deine Antwort wurde gespeichert</small>";
        wrapper.appendChild(doneLabel);
      }

      async function checkAnswer(questId, chosen, correct, xp, wrapper) {
        const user = auth.currentUser;
        if (!user) return alert("Benutzer nicht angemeldet.");
        if (chosen === correct) {
          alert(`‚úÖ Richtig! +${xp} XP`);
          // Sofort UI-Feedback (auch auf Handy)
          showQuestCompleted(wrapper);
          // Deaktiviere weitere Interaktion
          wrapper
            .querySelectorAll("button")
            .forEach((btn) => (btn.disabled = true));

          // In Firestore speichern (try/catch -> Fehler in Konsole)
          try {
            await db
              .collection("users")
              .doc(user.uid)
              .collection("progress")
              .doc(questId)
              .set({
                done: true,
                xp,
                completedAt: firebase.firestore.FieldValue.serverTimestamp(),
              });
          } catch (e) {
            console.error("progress write error", e);
          }

          // XP hinzuf√ºgen (transaktion)
          try {
            await addXP(user.uid, xp);
          } catch (e) {
            console.error("addXP error", e);
          }
        } else {
          alert("‚ùå Falsch, versuch's nochmal!");
        }
      }

      async function loadLeaderboard() {
        leaderboardList.innerHTML = "Lade...";
        try {
          const snap = await db
            .collection("users")
            .orderBy("totalXP", "desc")
            .get();
          leaderboardList.innerHTML = "";
          let rank = 1;
          const seenUsers = new Set();
          snap.forEach((d) => {
            const u = d.data();
            if (seenUsers.has(u.username)) return;
            seenUsers.add(u.username);
            const el = document.createElement("div");
            el.innerHTML = `<strong>${rank}. ${escapeHtml(
              u.username || d.id
            )}</strong> ‚Äî XP: ${u.totalXP || 0}, Level: ${u.level || 0}`;
            const barContainer = document.createElement("div");
            barContainer.className = "bar-container";
            const bar = document.createElement("div");
            bar.className = "bar";
            barContainer.appendChild(bar);
            el.appendChild(barContainer);
            leaderboardList.appendChild(el);
            requestAnimationFrame(() => {
              const progress = (u.totalXP || 0) % 100;
              bar.style.width = progress + "%";
            });
            rank++;
          });
        } catch (e) {
          console.error("leaderboard load error", e);
          leaderboardList.textContent = "Fehler beim Laden des Leaderboards.";
        }
      }

      // ----- Beispiel- + zus√§tzliche Programmier-Quests -----
      async function addSampleQuests() {
        try {
          const questsRef = db.collection("quests");
          const snap = await questsRef.get();
          if (!snap.empty) {
            console.log("Quests bereits vorhanden, nichts hinzugef√ºgt.");
            return;
          }

          const sampleQuests = [
            // deine bisherigen Beispiele (bleiben)
            {
              title: "Variablen verstehen",
              category: "JavaScript Grundlagen",
              question:
                "Wie deklariert man in JavaScript eine Variable, die sich nicht √§ndert?",
              answers: ["let", "var", "const", "static"],
              correctIndex: 2,
              xp: 15,
            },
            {
              title: "Mathe-Basis",
              category: "Mathematik",
              question: "Was ist 2 + 2?",
              answers: ["3", "4", "5"],
              correctIndex: 1,
              xp: 10,
            },
            {
              title: "Programmier-Quiz",
              category: "Code",
              question:
                "Welches Schl√ºsselwort wird in JavaScript verwendet, um eine Variable zu deklarieren?",
              answers: ["var", "let", "beide"],
              correctIndex: 2,
              xp: 15,
            },
            {
              title: "Allgemeinwissen",
              category: "Wissen",
              question: "Wie viele Kontinente gibt es auf der Erde?",
              answers: ["5", "6", "7"],
              correctIndex: 2,
              xp: 10,
            },

            // zus√§tzliche Programmier-Quests (neu)
            {
              title: "Array Index",
              category: "JavaScript",
              question:
                "Wie greift man in JS auf das erste Element eines Arrays 'arr' zu?",
              answers: ["arr[0]", "arr[1]", "arr.first"],
              correctIndex: 0,
              xp: 12,
            },
            {
              title: "Funktionen",
              category: "JavaScript",
              question:
                "Welches Wort erstellt eine Funktion in JS (klassisch)?",
              answers: ["function", "func", "def"],
              correctIndex: 0,
              xp: 12,
            },
            {
              title: "CSS Selektor",
              category: "CSS",
              question:
                "Welcher Selektor w√§hlt ein Element mit id='header' aus?",
              answers: [".header", "#header", "header"],
              correctIndex: 1,
              xp: 12,
            },
            {
              title: "HTML Struktur",
              category: "HTML",
              question: "Welches Tag ist f√ºr einen Absatz in HTML zust√§ndig?",
              answers: ["<p>", "<div>", "<span>"],
              correctIndex: 0,
              xp: 10,
            },
            {
              title: "Python Grund",
              category: "Python",
              question: "Wie kommentiert man eine einzelne Zeile in Python?",
              answers: ["// Kommentar", "# Kommentar", "/* Kommentar */"],
              correctIndex: 1,
              xp: 12,
            },
            {
              title: "Promise",
              category: "JavaScript",
              question: "Welcher Methodename geh√∂rt zu Promises?",
              answers: ["then", "wait", "sleep"],
              correctIndex: 0,
              xp: 15,
            },
          ];

          for (const q of sampleQuests) {
            await questsRef.add(q);
          }
          console.log("Beispiel-Quests erfolgreich hinzugef√ºgt!");
        } catch (e) {
          console.error("addSampleQuests error", e);
        }
      }

      // small helper: observe fade-ins
      window.addEventListener("scroll", () => {
        const navbar = document.querySelector(".navbar");
        if (window.scrollY > 80) navbar.classList.add("small");
        else navbar.classList.remove("small");
      });

      const observer = new IntersectionObserver(
        (entries) => {
          entries.forEach((e) => {
            if (e.isIntersecting) e.target.classList.add("visible");
          });
        },
        { threshold: 0.12 }
      );
      document
        .querySelectorAll(".fade-in")
        .forEach((el) => observer.observe(el));
    </script>
  </body>
</html>
